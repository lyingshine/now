# 工作制度功能说明

## 功能概述
新增工作制度设置，支持多种工作模式，自动计算工作日和收入。

## 支持的工作制度

### 1. 双休（默认）
- **说明**：周六、周日休息
- **工作日**：周一至周五
- **适用**：大部分互联网公司、外企

### 2. 大小休
- **说明**：隔周单休
- **工作日**：
  - 偶数周：周一至周五（双休）
  - 奇数周：周一至周六（单休，周日休息）
- **适用**：部分制造业、服务业

### 3. 单休
- **说明**：仅周日休息
- **工作日**：周一至周六
- **适用**：零售业、餐饮业

### 4. 全勤
- **说明**：无休息日
- **工作日**：每天都工作
- **适用**：特殊行业、项目赶工期

### 5. 自定义工作天数
- **说明**：手动设置每月工作天数
- **工作日**：按日历天数计算
- **适用**：灵活工作制、自由职业

## 计算逻辑

### 日收入计算
```
日收入 = 月薪 ÷ 每月工作天数
```

- **双休/大小休/单休/全勤**：系统自动计算每月实际工作天数
- **自定义**：使用用户设置的工作天数

### 本月收入计算
```
本月收入 = 日收入 × 本月已工作天数 + 今天实时收入
```

**本月已工作天数**：
- 从本月1号（或入职日期）到昨天
- 根据工作制度自动排除休息日
- 不包含今天（今天单独实时计算）

### 示例

#### 双休制度
- 月薪：10000元
- 工作制度：双休
- 本月（11月）：30天，其中工作日约22天
- 日收入：10000 ÷ 22 ≈ 454.55元
- 今天11月10日，本月已过7个工作日（排除周末）
- 本月收入：454.55 × 7 + 今天实时 ≈ 3181元 + 今天实时

#### 大小休制度
- 月薪：10000元
- 工作制度：大小休
- 本月（11月）：30天，其中工作日约26天
- 日收入：10000 ÷ 26 ≈ 384.62元
- 今天11月10日，本月已过8个工作日（部分周六工作）
- 本月收入：384.62 × 8 + 今天实时 ≈ 3077元 + 今天实时

#### 自定义工作天数
- 月薪：10000元
- 工作制度：自定义（设置22天）
- 日收入：10000 ÷ 22 ≈ 454.55元
- 今天11月10日，本月已过9天（按日历天数）
- 本月收入：454.55 × 9 + 今天实时 ≈ 4091元 + 今天实时

## 使用方法

1. 打开设置（点击右上角设置按钮）
2. 找到"工作制度"选项
3. 选择适合的工作制度：
   - 双休（周六日休息）
   - 大小休（隔周单休）
   - 单休（仅周日休息）
   - 全勤（无休息日）
   - 自定义工作天数
4. 如果选择"自定义工作天数"，会显示输入框，可以手动设置每月工作天数
5. 点击"保存设置"

## 技术实现

### 工作日判断
```javascript
function isWorkDay(date, weekNumber) {
    const day = date.getDay(); // 0=周日, 6=周六
    const schedule = workScheduleInput.value;
    
    switch(schedule) {
        case 'double': // 双休
            return day !== 0 && day !== 6;
        case 'single': // 单休
            return day !== 0;
        case 'alternate': // 大小休
            if (weekNumber % 2 === 0) {
                return day !== 0 && day !== 6; // 双休
            } else {
                return day !== 0; // 单休
            }
        case 'full': // 全勤
            return true;
        case 'custom': // 自定义
            return true; // 按日历天数
    }
}
```

### 周数计算
大小休使用 ISO 8601 标准计算周数，确保每年的周数计算一致。

## 注意事项

1. **工作制度影响收入计算**：不同工作制度会影响日收入和累计收入的计算
2. **大小休的周数**：从年初开始计算，偶数周双休，奇数周单休
3. **自定义模式**：按日历天数计算，不区分工作日和休息日
4. **实时更新**：切换工作制度后，所有收入数据会立即重新计算

## 未来改进

1. 支持自定义休息日（如周三休息）
2. 支持法定节假日自动识别
3. 支持调休设置
4. 支持加班工资计算

# NOW 职场成长平台 - 统一样式系统架构

## 设计原则

1. **层级清晰**：从基础到具体，从通用到特殊
2. **单一职责**：每个文件只负责一个明确的功能
3. **可预测性**：样式优先级明确，避免意外覆盖
4. **可维护性**：易于查找、修改和扩展
5. **无冗余**：避免重复定义，统一管理

## 样式层级结构

```
第 0 层：设计令牌（Design Tokens）
  ├─ 颜色系统
  ├─ 间距系统
  ├─ 字体系统
  ├─ 阴影系统
  ├─ 动画缓动
  └─ 布局断点

第 1 层：基础样式（Base）
  ├─ CSS Reset
  ├─ 全局元素样式
  ├─ 主题变量（浅色/暗色）
  └─ 滚动条样式

第 2 层：布局系统（Layout）
  ├─ 容器
  ├─ 网格
  ├─ 间距工具类
  └─ 响应式布局

第 3 层：组件样式（Components）
  ├─ 按钮
  ├─ 卡片
  ├─ 输入框
  ├─ 标签
  ├─ 进度条
  └─ 其他基础组件

第 4 层：模式样式（Patterns）
  ├─ 导航栏
  ├─ 模态框
  ├─ 表单
  └─ 列表

第 5 层：主题增强（Theme Enhancements）
  ├─ 浅色模式特定样式
  └─ 暗色模式特定样式

第 6 层：动画效果（Animations）
  ├─ 过渡动画
  ├─ 关键帧动画
  └─ 交互动画

第 7 层：工具类（Utilities）
  ├─ 间距工具
  ├─ 文字工具
  ├─ 显示工具
  └─ 响应式工具

第 8 层：页面特定样式（Page Specific）
  ├─ 首页
  ├─ 任务大厅
  ├─ 成长中心
  └─ 其他页面
```

## 文件组织

### 核心文件（按加载顺序）

1. **design-tokens.css** - 设计令牌
   - 所有设计变量的唯一来源
   - 不包含任何选择器，只有 CSS 变量

2. **base.css** - 基础样式
   - CSS Reset
   - 全局元素样式（html, body, a, button 等）
   - 主题变量定义（浅色/暗色模式）

3. **layout.css** - 布局系统
   - 容器、网格、间距
   - 不包含颜色、字体等装饰性样式

4. **components.css** - 基础组件
   - 可复用的 UI 组件
   - 使用设计令牌，不硬编码值

5. **patterns.css** - 组合模式
   - 由多个组件组合的复杂模式
   - 导航、模态框等

6. **theme-light.css** - 浅色主题
   - 仅包含浅色模式的覆盖样式
   - 使用 `html:not(.dark)` 选择器

7. **theme-dark.css** - 暗色主题
   - 仅包含暗色模式的覆盖样式
   - 使用 `.dark` 选择器

8. **animations.css** - 动画系统
   - 所有动画定义
   - 关键帧和过渡

9. **utilities.css** - 工具类
   - 单一用途的工具类
   - 可以使用 !important

10. **responsive.css** - 响应式
    - 媒体查询
    - 移动端适配

## 命名规范

### BEM 命名法
```css
.block {}
.block__element {}
.block--modifier {}
```

### 状态类
```css
.is-active {}
.is-disabled {}
.is-loading {}
.has-error {}
```

### 主题类
```css
.theme-light {}
.theme-dark {}
```

### 响应式类
```css
.sm\:hidden {}
.md\:flex {}
.lg\:grid {}
```

## 样式优先级规则

1. **设计令牌** - 最低优先级，可被任何样式覆盖
2. **基础样式** - 全局默认样式
3. **组件样式** - 组件特定样式
4. **主题样式** - 主题覆盖样式
5. **状态样式** - 交互状态样式
6. **工具类** - 最高优先级，可使用 !important

## 避免的反模式

❌ **不要做：**
- 在多个文件中定义相同的样式
- 使用过于具体的选择器（如 `.page .section .card .button`）
- 硬编码颜色、间距等值
- 在组件样式中使用 !important
- 混合不同层级的样式

✅ **应该做：**
- 使用设计令牌
- 保持选择器简洁
- 遵循单一职责原则
- 使用语义化的类名
- 按层级组织样式

## 主题切换机制

```css
/* 设计令牌中定义变量 */
:root {
  --color-primary: #667eea;
  --bg-primary: #ffffff;
}

/* 暗色模式覆盖 */
.dark {
  --bg-primary: #121212;
}

/* 组件使用变量 */
.card {
  background: var(--bg-primary);
}
```

## 性能优化

1. **减少选择器深度**：最多 3 层
2. **避免通配符**：不使用 `*` 选择器
3. **合并相似规则**：使用 CSS 变量
4. **按需加载**：页面特定样式可以按需加载
5. **压缩输出**：生产环境压缩 CSS

## 维护指南

### 添加新样式时
1. 确定样式属于哪个层级
2. 检查是否可以使用现有的设计令牌
3. 避免重复定义
4. 遵循命名规范
5. 添加注释说明用途

### 修改现有样式时
1. 查找所有使用该样式的地方
2. 评估影响范围
3. 优先修改设计令牌而非具体样式
4. 测试浅色和暗色模式
5. 测试响应式布局

### 删除样式时
1. 确认样式未被使用
2. 检查是否有依赖
3. 逐步删除，避免一次性大改
4. 保留必要的注释

## 迁移计划

### 第一阶段：审计
- [ ] 列出所有样式文件
- [ ] 识别重复样式
- [ ] 标记冗余代码
- [ ] 记录问题样式

### 第二阶段：重构
- [ ] 创建新的文件结构
- [ ] 迁移设计令牌
- [ ] 重构基础样式
- [ ] 重构组件样式
- [ ] 统一主题样式

### 第三阶段：优化
- [ ] 删除冗余代码
- [ ] 优化选择器
- [ ] 统一命名
- [ ] 添加文档

### 第四阶段：测试
- [ ] 视觉回归测试
- [ ] 响应式测试
- [ ] 主题切换测试
- [ ] 性能测试

## 工具推荐

- **Stylelint**：CSS 代码检查
- **PostCSS**：CSS 处理
- **PurgeCSS**：移除未使用的 CSS
- **CSS Stats**：分析 CSS 复杂度

# 职业任务系统需求文档

## 引言

重新设计职业成长模拟器，将其打造成一个真正的"人生职业RPG"。核心理念：**一个人的一生只会接取少数几个职业任务，每次接取任务都是一次重要的职业选择，用户应该全身心投入当前任务，通过完成所有子任务最终达到满级（100级）并胜任该岗位。**

## 术语表

- **主任务（Main Quest）**: 用户接取的职位目标，代表一次职业选择
- **子任务（Sub Quest）**: 岗位任职要求分解的学习任务，循序渐进
- **经验值（EXP）**: 完成子任务获得的成长值，累计达到100级
- **终极奖励（Ultimate Reward）**: 完成所有子任务并胜任岗位后的最终奖励
- **任务确认（Quest Completion）**: 用户手动确认已完成任务并胜任岗位

## 需求

### 需求 1: 单一任务专注机制

**用户故事**: 作为用户，我希望一次只能专注于一个职业任务，这样我可以全身心投入当前的职业目标。

#### 验收标准

1. WHEN 用户未接取任何任务时，THE 系统 SHALL 显示任务大厅供用户选择
2. WHEN 用户已接取一个任务时，THE 系统 SHALL 隐藏任务大厅入口，只显示当前任务进度
3. WHEN 用户访问任务大厅时，THE 系统 SHALL 检查是否已有进行中的任务
4. IF 用户已有进行中的任务，THEN THE 系统 SHALL 提示"你已经在进行一个职业任务，请先完成或放弃当前任务"
5. WHEN 用户完成或放弃当前任务后，THE 系统 SHALL 重新开放任务大厅

### 需求 2: 100级成长体系

**用户故事**: 作为用户，我希望通过完成所有子任务从1级成长到100级，这样我能清晰看到自己的成长进度。

#### 验收标准

1. WHEN 用户接取新任务时，THE 系统 SHALL 将用户等级重置为1级
2. WHEN 用户完成一个子任务时，THE 系统 SHALL 根据子任务经验值增加用户等级
3. THE 系统 SHALL 确保所有子任务的总经验值恰好让用户达到100级
4. WHEN 用户等级提升时，THE 系统 SHALL 显示升级动画和当前等级
5. THE 系统 SHALL 在界面显著位置展示当前等级和经验进度条

### 需求 3: 循序渐进的子任务设计

**用户故事**: 作为用户，我希望子任务按照学习难度循序渐进排列，这样我可以逐步掌握岗位技能。

#### 验收标准

1. THE 系统 SHALL 将岗位要求分解为多个子任务（建议6-10个）
2. THE 系统 SHALL 按照"基础→进阶→高级→综合"的顺序排列子任务
3. WHEN 用户查看子任务列表时，THE 系统 SHALL 显示每个子任务的难度等级
4. THE 系统 SHALL 为每个子任务分配合理的经验值权重
5. THE 系统 SHALL 确保基础任务经验值较少，高级任务经验值较多

### 需求 4: 自定义任务奖励

**用户故事**: 作为用户，我希望能够自定义每个子任务的奖励和最终奖励，这样我可以设定自己的激励机制。

#### 验收标准

1. WHEN 用户接取任务时，THE 系统 SHALL 提供奖励设置界面
2. THE 系统 SHALL 允许用户为每个子任务设置自定义奖励（文本描述）
3. THE 系统 SHALL 允许用户设置任务完成后的终极奖励
4. THE 系统 SHALL 保存用户设置的奖励信息
5. WHEN 用户完成子任务时，THE 系统 SHALL 显示该子任务的自定义奖励

### 需求 5: 经验值合理分配

**用户故事**: 作为用户，我希望系统能够合理分配经验值，确保我完成所有子任务后恰好达到100级。

#### 验收标准

1. THE 系统 SHALL 计算总经验值为固定值（如10000 EXP = 100级）
2. THE 系统 SHALL 根据子任务数量和难度自动分配经验值
3. THE 系统 SHALL 使用权重算法：基础任务权重1，进阶任务权重1.5，高级任务权重2
4. THE 系统 SHALL 确保所有子任务经验值总和等于10000 EXP
5. THE 系统 SHALL 允许用户手动调整每个子任务的经验值

### 需求 6: 任务完成确认机制

**用户故事**: 作为用户，我希望在完成所有子任务后手动确认任务完成，这样我可以确保自己真正胜任该岗位。

#### 验收标准

1. WHEN 用户完成所有子任务时，THE 系统 SHALL 显示"任务完成确认"按钮
2. THE 系统 SHALL 在确认界面展示任务总结（完成时间、获得经验、等级）
3. WHEN 用户点击确认时，THE 系统 SHALL 显示终极奖励和成就解锁动画
4. THE 系统 SHALL 将任务标记为"已完成"状态
5. WHEN 任务完成后，THE 系统 SHALL 重新开放任务大厅供用户选择新任务

### 需求 7: 任务进度可视化

**用户故事**: 作为用户，我希望清晰看到当前任务的整体进度，包括等级、经验值、完成的子任务数量。

#### 验收标准

1. THE 系统 SHALL 在首页显著位置展示当前任务信息
2. THE 系统 SHALL 显示当前等级和经验进度条（X级 / 100级）
3. THE 系统 SHALL 显示子任务完成进度（X/Y 已完成）
4. THE 系统 SHALL 显示预计完成时间和已用时间
5. THE 系统 SHALL 使用游戏化的视觉元素（进度条、徽章、动画）

### 需求 8: 任务历史记录

**用户故事**: 作为用户，我希望查看我过去完成的所有职业任务，这样我可以回顾自己的职业成长历程。

#### 验收标准

1. THE 系统 SHALL 保存用户完成的所有任务记录
2. THE 系统 SHALL 为每个完成的任务记录开始时间、完成时间、获得经验
3. WHEN 用户查看历史记录时，THE 系统 SHALL 显示任务列表和详细信息
4. THE 系统 SHALL 为完成的任务颁发成就徽章
5. THE 系统 SHALL 统计用户的总成长数据（总等级、总任务数、总学习时长）

### 需求 9: 任务放弃机制优化

**用户故事**: 作为用户，我希望在放弃任务时得到明确的警告，因为这代表放弃一次职业选择。

#### 验收标准

1. WHEN 用户点击放弃任务时，THE 系统 SHALL 显示严肃的确认对话框
2. THE 系统 SHALL 在对话框中说明放弃的后果（等级重置、进度清空）
3. THE 系统 SHALL 要求用户输入确认文本（如"我确认放弃"）
4. WHEN 用户确认放弃后，THE 系统 SHALL 清空当前任务数据
5. THE 系统 SHALL 记录放弃的任务到历史记录（标记为"已放弃"）

### 需求 10: 智能任务推荐

**用户故事**: 作为用户，我希望系统能够根据我的历史任务推荐合适的下一个职业目标。

#### 验收标准

1. WHEN 用户完成一个任务后，THE 系统 SHALL 分析用户的技能积累
2. THE 系统 SHALL 推荐薪资提升20%-50%的相关职位
3. THE 系统 SHALL 标注推荐理由（如"基于你的前端经验，适合进阶全栈"）
4. THE 系统 SHALL 显示推荐任务的难度和预计学习时长
5. THE 系统 SHALL 允许用户忽略推荐，自由选择任何任务

## 数据模型

### 任务状态
- `not_started`: 未开始
- `in_progress`: 进行中（用户当前专注的任务）
- `completed`: 已完成（用户确认胜任）
- `abandoned`: 已放弃

### 等级系统
- 等级范围: 1-100
- 总经验值: 10000 EXP
- 每级所需经验: 100 EXP

### 子任务权重
- 基础任务: 权重 1.0
- 进阶任务: 权重 1.5
- 高级任务: 权重 2.0
- 综合任务: 权重 2.5

## 用户流程

1. **首次使用**: 用户进入任务大厅 → 选择职业目标 → 设置奖励 → 开始任务
2. **任务进行中**: 查看任务进度 → 完成子任务 → 获得经验升级 → 继续下一个子任务
3. **任务完成**: 完成所有子任务 → 达到100级 → 确认任务完成 → 获得终极奖励
4. **开始新任务**: 查看历史记录 → 进入任务大厅 → 选择新职业目标 → 重复流程

## 成功指标

1. 用户平均完成一个任务的时间: 3-6个月
2. 用户任务完成率: > 60%
3. 用户平均完成任务数: 2-3个/年
4. 用户满意度: > 4.5/5.0
5. 用户留存率: > 70%（30天）

## 技术约束

1. 所有数据必须保存到 localStorage
2. 等级计算必须精确，避免浮点数误差
3. 动画效果必须流畅（60fps）
4. 支持明暗主题切换
5. 响应式设计，支持移动端

## 优先级

- P0（必须）: 需求1、2、3、5、6、7
- P1（重要）: 需求4、8、9
- P2（可选）: 需求10

---

**文档版本**: 1.0  
**创建日期**: 2025-01-XX  
**状态**: 待审核

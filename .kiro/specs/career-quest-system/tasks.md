# 职业任务系统实施计划

## 任务列表

- [x] 1. 数据模型重构

  - 创建新的 Quest 数据结构，支持100级系统和子任务管理
  - 实现经验值分配算法，根据难度权重自动计算
  - 迁移现有 learningPlans 数据到新的 Quest 模型
  - _需求: 1.1, 2.1, 3.1, 5.1_

- [x] 1.1 创建 Quest 数据类型定义


  - 在 `src/types/quest.ts` 创建 TypeScript 接口
  - 定义 Quest、SubTask、LearningStep 类型
  - 定义任务状态枚举和难度等级枚举
  - _需求: 2.1, 3.1_



- [x] 1.2 实现经验值计算工具函数

  - 在 `src/utils/expCalculator.js` 创建经验值计算函数
  - 实现 `calculateExpDistribution()` - 根据难度分配经验值
  - 实现 `calculateLevel()` - 根据总经验计算等级
  - 实现 `getLevelProgress()` - 计算当前等级进度百分比
  - _需求: 2.2, 5.2, 5.3_

- [x] 1.3 重构 QuestStore (Pinia)


  - 修改 `src/stores/jobs.js` 为 `src/stores/quest.js`
  - 添加 `currentQuest` 状态（单一任务）
  - 添加 `questHistory` 状态（历史记录）
  - 实现 `hasActiveQuest` 计算属性
  - 实现 `currentLevel` 计算属性
  - _需求: 1.1, 2.1_

- [x] 2. 单一任务专注机制


  - 实现任务接取限制，确保用户一次只能有一个进行中的任务
  - 修改任务大厅，当有进行中任务时显示提示并禁用接取
  - 添加任务状态检查逻辑


  - _需求: 1.1, 1.2, 1.3, 1.4_

- [x] 2.1 实现任务接取验证

  - 在 QuestStore 添加 `canAcceptNewQuest()` 方法


  - 检查是否已有进行中的任务
  - 返回验证结果和提示信息
  - _需求: 1.2, 1.3_

- [x] 2.2 修改任务大厅组件

  - 修改 `src/views/Jobs.vue` 添加任务状态检查
  - 当有进行中任务时显示警告提示
  - 禁用所有职位卡片的点击事件
  - 添加"查看当前任务"按钮
  - _需求: 1.2, 1.4_

- [x] 2.3 修改导航逻辑


  - 修改 `src/router/index.js` 添加路由守卫
  - 当有进行中任务时，重定向任务大厅访问到当前任务页面
  - 添加路由元信息标识
  - _需求: 1.3_

- [x] 3. 100级成长系统


  - 实现1-100级的等级系统，总经验值10000
  - 创建等级显示组件，展示当前等级和经验进度
  - 实现升级动画效果

  - _需求: 2.1, 2.2, 2.3, 2.4, 2.5_

- [x] 3.1 创建等级系统组件

  - 创建 `src/components/game/LevelDisplay.vue`
  - 显示当前等级（Lv.XX / 100）
  - 显示经验进度条（XX / 100 EXP）
  - 添加等级图标和样式
  - _需求: 2.4, 2.5_

- [x] 3.2 实现升级动画组件


  - 修改 `src/components/game/LevelUpModal.vue`
  - 添加等级提升动画（光芒、数字放大）
  - 显示获得的经验值
  - 添加里程碑提示（25级、50级、75级、100级）
  - _需求: 2.4_

- [x] 3.3 集成等级系统到首页


  - 修改 `src/views/Home.vue` 添加等级显示
  - 替换原有的玩家等级为真实等级
  - 显示当前任务信息（如果有）
  - 添加"继续任务"快捷按钮
  - _需求: 2.5_

- [x] 4. 子任务经验值分配

  - 根据子任务难度自动分配经验值
  - 确保所有子任务经验值总和为10000
  - 实现经验值手动调整功能
  - _需求: 3.2, 3.3, 5.1, 5.2, 5.3, 5.4, 5.5_

- [x] 4.1 实现子任务生成逻辑


  - 修改 `src/stores/quest.js` 的 `generateLearningPlan()` 方法
  - 为每个岗位要求分配难度等级（basic/intermediate/advanced/expert）
  - 调用经验值分配算法计算每个子任务的经验值
  - 验证总经验值等于10000
  - _需求: 3.2, 5.2, 5.3, 5.4_

- [x] 4.2 创建经验值调整界面


  - 创建 `src/components/quest/ExpAdjustment.vue`
  - 显示每个子任务的经验值
  - 允许用户手动调整经验值
  - 实时显示总经验值和剩余经验值
  - 验证总和必须等于10000
  - _需求: 5.5_

- [x] 5. 自定义奖励系统


  - 创建奖励设置界面，允许用户为每个子任务设置奖励
  - 实现终极奖励设置
  - 保存和显示自定义奖励
  - _需求: 4.1, 4.2, 4.3, 4.4, 4.5_

- [x] 5.1 创建奖励设置组件




  - 创建 `src/components/quest/RewardSetup.vue`
  - 显示所有子任务列表
  - 为每个子任务提供奖励输入框
  - 添加终极奖励输入区域
  - 提供奖励建议和示例
  - _需求: 4.2, 4.3_

- [x] 5.2 集成奖励设置到任务接取流程


  - 修改 `src/components/JobModal.vue`
  - 在接取任务前显示奖励设置界面
  - 保存用户设置的奖励到 Quest 数据
  - 添加"跳过设置"选项（使用默认奖励）
  - _需求: 4.1, 4.4_

- [x] 5.3 在任务完成时显示奖励

  - 修改 `src/components/growth-detail/TaskItem.vue`
  - 完成子任务时显示自定义奖励
  - 添加奖励展示动画
  - _需求: 4.5_

- [x] 6. 任务完成确认机制

  - 实现任务完成验证逻辑
  - 创建任务完成确认界面
  - 显示终极奖励和成就
  - _需求: 6.1, 6.2, 6.3, 6.4, 6.5_

- [x] 6.1 实现任务完成验证


  - 在 QuestStore 添加 `canCompleteQuest()` 方法
  - 检查所有子任务是否完成
  - 检查是否达到100级
  - 返回验证结果
  - _需求: 6.1_

- [x] 6.2 创建任务完成确认组件


  - 创建 `src/components/quest/QuestCompletionModal.vue`
  - 显示任务总结（完成时间、总经验、等级）
  - 显示终极奖励
  - 显示成就徽章
  - 添加烟花动画效果
  - _需求: 6.2, 6.3_

- [x] 6.3 实现任务完成逻辑

  - 在 QuestStore 添加 `confirmQuestCompletion()` 方法
  - 标记任务为已完成
  - 添加到历史记录
  - 清空当前任务
  - 解锁成就
  - _需求: 6.4, 6.5_

- [ ] 7. 任务进度可视化
  - 优化任务进度展示界面
  - 显示等级、经验值、子任务完成数
  - 添加预计完成时间
  - _需求: 7.1, 7.2, 7.3, 7.4, 7.5_

- [ ] 7.1 创建任务进度卡片组件
  - 创建 `src/components/quest/QuestProgressCard.vue`
  - 显示任务标题和目标薪资
  - 显示当前等级和经验进度条
  - 显示子任务完成进度（X/Y）
  - 显示开始日期和已用时间
  - _需求: 7.1, 7.2, 7.3, 7.4_

- [ ] 7.2 集成进度卡片到首页
  - 修改 `src/views/Home.vue`
  - 在顶部显著位置展示任务进度卡片
  - 添加"继续任务"按钮
  - 当无任务时显示"开始新任务"按钮
  - _需求: 7.1, 7.5_

- [ ] 7.3 优化任务详情页面
  - 修改 `src/views/GrowthDetail.vue`
  - 在顶部添加整体进度概览
  - 显示完成百分比和预计剩余时间
  - 添加激励文案
  - _需求: 7.3, 7.4_

- [ ] 8. 任务历史记录
  - 创建历史记录页面
  - 显示已完成和已放弃的任务
  - 展示成就徽章和统计数据
  - _需求: 8.1, 8.2, 8.3, 8.4, 8.5_

- [ ] 8.1 创建历史记录页面
  - 创建 `src/views/QuestHistory.vue`
  - 以时间线形式展示历史任务
  - 区分已完成和已放弃任务
  - 显示每个任务的关键信息
  - _需求: 8.1, 8.3_

- [ ] 8.2 实现历史记录数据管理
  - 在 QuestStore 添加历史记录相关方法
  - 实现 `addToHistory()` - 添加任务到历史
  - 实现 `getQuestHistory()` - 获取历史记录
  - 实现 `getQuestStats()` - 获取统计数据
  - _需求: 8.2, 8.5_

- [ ] 8.3 创建成就系统
  - 创建 `src/utils/achievements.js`
  - 定义成就列表（首次完成、连续完成、高薪任务等）
  - 实现成就解锁逻辑
  - 在历史记录中显示成就徽章
  - _需求: 8.4_

- [ ] 9. 任务放弃机制优化
  - 优化任务放弃确认流程
  - 添加严肃的警告提示
  - 记录放弃的任务
  - _需求: 9.1, 9.2, 9.3, 9.4, 9.5_

- [ ] 9.1 创建任务放弃确认组件
  - 创建 `src/components/quest/AbandonQuestModal.vue`
  - 显示严肃的警告信息
  - 说明放弃的后果（等级重置、进度清空）
  - 要求用户输入确认文本"我确认放弃"
  - 添加二次确认按钮
  - _需求: 9.1, 9.2, 9.3_

- [ ] 9.2 实现任务放弃逻辑
  - 在 QuestStore 添加 `abandonQuest()` 方法
  - 标记任务为已放弃
  - 添加到历史记录（标记为abandoned）
  - 清空当前任务
  - 重置等级为1
  - _需求: 9.4, 9.5_

- [ ] 9.3 集成放弃确认到任务详情页
  - 修改 `src/components/growth-detail/ProgressHeader.vue`
  - 点击"放弃任务"按钮时显示确认弹窗
  - 验证用户输入的确认文本
  - 确认后执行放弃逻辑
  - _需求: 9.1, 9.3_

- [ ] 10. 路由和导航优化
  - 优化路由结构，适配新的任务系统
  - 添加路由守卫，保护任务状态
  - 优化导航栏显示逻辑
  - _需求: 1.3, 1.5_

- [ ] 10.1 重构路由配置
  - 修改 `src/router/index.js`
  - 添加任务历史记录路由
  - 添加路由守卫检查任务状态
  - 实现条件重定向逻辑
  - _需求: 1.3_

- [ ] 10.2 优化导航栏
  - 修改 `src/components/Navbar.vue`
  - 当有进行中任务时，隐藏"任务大厅"链接
  - 显示"当前任务"链接
  - 添加"历史记录"链接
  - 根据任务状态动态调整导航项
  - _需求: 1.5_

- [x] 11. 数据迁移和兼容性

  - 实现数据迁移脚本，将旧数据转换为新格式
  - 保持向后兼容性
  - 添加数据验证和修复逻辑
  - _需求: 所有需求_

- [x] 11.1 创建数据迁移工具

  - 创建 `src/utils/dataMigration.js`
  - 实现 `migrateOldData()` - 转换旧的 learningPlans 数据
  - 实现 `validateQuestData()` - 验证数据完整性
  - 实现 `repairQuestData()` - 修复损坏的数据
  - _需求: 所有需求_

- [x] 11.2 在应用启动时执行迁移

  - 修改 `src/main.js` 或 `src/App.vue`
  - 在应用初始化时检查数据版本
  - 自动执行数据迁移
  - 显示迁移进度（如果需要）
  - _需求: 所有需求_

- [ ] 12. 测试和优化
  - 编写单元测试验证核心算法
  - 进行端到端测试验证完整流程
  - 性能优化和用户体验改进
  - _需求: 所有需求_

- [ ]* 12.1 编写单元测试
  - 测试经验值分配算法
  - 测试等级计算函数
  - 测试任务状态验证
  - 测试数据迁移逻辑
  - _需求: 所有需求_

- [ ]* 12.2 编写集成测试
  - 测试任务接取流程
  - 测试子任务完成流程
  - 测试任务完成确认流程
  - 测试任务放弃流程
  - _需求: 所有需求_

- [ ] 12.3 性能优化
  - 优化经验值计算性能
  - 优化大量子任务渲染
  - 添加加载状态和骨架屏
  - 优化动画性能
  - _需求: 所有需求_

- [ ] 13. 文档和发布
  - 更新 README 文档
  - 创建用户使用指南
  - 准备发布说明
  - _需求: 所有需求_

- [ ] 13.1 更新 README
  - 更新项目介绍，说明新的任务系统
  - 添加核心功能说明
  - 更新截图和演示
  - _需求: 所有需求_

- [ ] 13.2 创建用户指南
  - 创建 `docs/USER_GUIDE.md`
  - 说明如何接取任务
  - 说明如何完成子任务
  - 说明如何设置奖励
  - 说明如何确认任务完成
  - _需求: 所有需求_

---

**总任务数**: 40个主任务 + 2个可选测试任务  
**预计工作量**: 5-7天  
**优先级**: 按任务编号顺序执行
